<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Sederhana</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; }
        .login { display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #333; color: white; }
        .login form { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); width: 300px; }
        .login input { width: 100%; padding: 0.5rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 4px; }
        .login button { width: 100%; padding: 0.5rem; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .login button:hover { background-color: #218838; }
        header { background-color: #333; color: white; text-align: center; padding: 1rem; display: none; }
        nav { display: flex; justify-content: center; background-color: #444; }
        nav button { background: none; color: white; border: none; padding: 1rem; cursor: pointer; font-size: 1rem; }
        nav button:hover, nav button.active { background-color: #555; }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; display: none; }
        .section { display: none; }
        .section.active { display: block; }
        .products { display: flex; flex-wrap: wrap; gap: 1rem; }
        .product { background: white; border: 1px solid #ddd; padding: 1rem; width: 300px; text-align: center; }
        .product img { width: 100%; height: 200px; object-fit: cover; }
        button { background-color: #28a745; color: white; border: none; padding: 0.5rem; cursor: pointer; margin: 0.2rem; }
        button:hover { background-color: #218838; }
        button.danger { background-color: #dc3545; }
        button.danger:hover { background-color: #c82333; }
        button.secondary { background-color: #6c757d; }
        button.secondary:hover { background-color: #5a6268; }
        .cart { background: white; border: 1px solid #ddd; padding: 1rem; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
        .profile { background: white; border: 1px solid #ddd; padding: 1rem; }
        .profile form { display: flex; flex-direction: column; gap: 1rem; }
        .profile input { padding: 0.5rem; }
        .product-detail { background: white; border: 1px solid #ddd; padding: 1rem; }
        .product-detail img { width: 100%; max-width: 400px; height: auto; }
        .rating { color: #ffc107; font-size: 1.5rem; }
        .reviews { margin-top: 2rem; }
        .review { border-bottom: 1px solid #ddd; padding: 0.5rem 0; }
        .review-form { margin-top: 2rem; }
        .review-form textarea { width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; }
        footer { background-color: #333; color: white; text-align: center; padding: 1rem; margin-top: 2rem; display: none; }
    </style>
</head>
<body>
    <div id="login" class="login">
        <form id="login-form">
            <h2>Login ke Toko Online</h2>
            <input type="text" id="username" placeholder="Username atau Email" required>
            <input type="password" id="password" placeholder="Password" required>
            <input type="text" id="name" placeholder="Nama Lengkap" required>
            <input type="tel" id="phone" placeholder="Nomor Handphone" required>
            <button type="submit">Login</button>
        </form>
    </div>
    <header>
        <h1>Toko Online MOCHIQUE</h1>
        <nav>
            <button id="nav-profile" onclick="showSection('profile')">Profil</button>
            <button id="nav-products" onclick="showSection('products')" class="active">Produk</button>
            <button id="nav-cart" onclick="showSection('cart')">Keranjang</button>
        </nav>
    </header>
    <div class="container">
        <div id="profile" class="section profile">
            <h2>Profil Pengguna</h2>
            <form id="profile-form">
                <label for="profile-name">Nama:</label>
                <input type="text" id="profile-name" placeholder="Masukkan nama Anda">
                <label for="profile-email">Email:</label>
                <input type="email" id="profile-email" placeholder="Masukkan email Anda">
                <label for="profile-address">Alamat:</label>
                <input type="text" id="profile-address" placeholder="Masukkan alamat Anda">
                <label for="profile-phone">Nomor Handphone:</label>
                <input type="tel" id="profile-phone" placeholder="Masukkan nomor handphone Anda">
                <button type="submit">Simpan Profil</button>
            </form>
        </div>
        <div id="products" class="section active">
            <h2>Produk Kami</h2>
            <div class="products" id="products-list">
                <!-- Produk akan ditambahkan secara dinamis oleh JS -->
            </div>
        </div>
        <div id="product-detail" class="section product-detail">
            <!-- Detail produk akan ditampilkan di sini -->
        </div>
        <div id="cart" class="section cart">
            <h2>Keranjang Belanja</h2>
            <div id="cart-items"></div>
            <p>Total: Rp <span id="total">0</span></p>
            <button onclick="clearCart()">Kosongkan Keranjang</button>
            <button onclick="checkout()">Checkout</button>
        </div>
    </div>
    <footer>
        <p>&copy; 2023 Toko Online. Dibuat dengan HTML, CSS, JS.</p>
    </footer>

    <script>
        // Data produk sederhana - diperbarui dengan nama baru
        const products = [
            { id: 1, name: 'mango cream', price: 6000, image: 'https://via.placeholder.com/300x200?text=MOCHIQUE+Mango+Cream' },
            { id: 2, name: 'strawberry chocolate', price: 7000, image: 'https://via.placeholder.com/300x200?text=MOCHIQUE+Strawberry+Chocolate' },
            { id: 3, name: 'matcha', price: 7000, image: 'https://via.placeholder.com/300x200?text=MOCHIQUE+Matcha' }
        ];

        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        // Fungsi untuk menampilkan produk
        function displayProducts() {
            const productsContainer = document.getElementById('products-list');
            products.forEach(product => {
                const productDiv = document.createElement('div');
                productDiv.className = 'product';
                productDiv.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <h3>${product.name}</h3>
                    <p>Rp ${product.price.toLocaleString()}</p>
                    <button onclick="addToCart(${product.id})">Tambah ke Keranjang</button>
                    <button class="secondary" onclick="showProductDetail(${product.id})">Cek Detail</button>
                `;
                productsContainer.appendChild(productDiv);
            });
        }

        // Fungsi untuk menampilkan detail produk
        function showProductDetail(id) {
            const product = products.find(p => p.id === id);
            const reviews = JSON.parse(localStorage.getItem(reviews-${id})) || [];
            const avgRating = reviews.length > 0 ? (reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length).toFixed(1) : 5;
            const stars = '★'.repeat(Math.round(avgRating)) + '☆'.repeat(5 - Math.round(avgRating));

            const detailContainer = document.getElementById('product-detail');
            detailContainer.innerHTML = `
                <button class="secondary" onclick="showSection('products')">Kembali</button>
                <h2>${product.name}</h2>
                <img src="${product.image}" alt="${product.name}">
                <p><strong>Harga:</strong> Rp ${product.price.toLocaleString()}</p>
                <p><strong>Rating:</strong> <span class="rating">${stars} (${avgRating}/5)</span></p>
                <div class="reviews">
                    <h3>Ulasan</h3>
                    ${reviews.length > 0 ? reviews.map(r => <div class="review"><strong>${r.name}:</strong> ${r.review} (${r.rating}★)</div>).join('') : '<p>Belum ada ulasan.</p>'}
                </div>
                <div class="review-form">
                    <h3>Tulis Ulasan Anda</h3>
                    <form id="review-form">
                        <input type="text" id="review-name" placeholder="Nama Anda" required>
                        <textarea id="review-text" placeholder="Tulis ulasan Anda..." required></textarea>
                        <label>Rating: <select id="review-rating">
                            <option value="5">5★</option>
                            <option value="4">4★</option>
                            <option value="3">3★</option>
                            <option value="2">2★</option>
                            <option value="1">1★</option>
                        </select></label>
                        <button type="submit">Kirim Ulasan</button>
                    </form>
                </div>
            `;

            // Preload nama dari profil
            document.getElementById('review-name').value = localStorage.getItem('name') || '';

            // Event listener untuk form ulasan
            document.getElementById('review-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('review-name').value;
                const review = document.getElementById('review-text').value;
                const rating = parseInt(document.getElementById('review-rating').value);
                reviews.push({ name, review, rating });
                localStorage.setItem(reviews-${id}, JSON.stringify(reviews));
                showProductDetail(id); // Refresh detail
                alert('Ulasan dikirim!');
            });

            showSection('product-detail');
        }

        // Fungsi untuk menambah ke keranjang
        function addToCart(id) {
            const product = products.find(p => p.id === id);
            const existing = cart.find(item => item.id === id);
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            saveCart();
            updateCart();
        }

        // Fungsi untuk update tampilan keranjang
        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = '';
            let total = 0;
            cart.forEach((item, index) => {
                total += item.price * item.quantity;
                const itemDiv = document.createElement('div');
                itemDiv.className = 'cart-item';
                itemDiv.innerHTML = `
                    <span>${item.name} (x${item.quantity}) - Rp ${(item.price * item.quantity).toLocaleString()}</span>
                    <button class="danger" onclick="removeFromCart(${index})">Hapus</button>
                `;
                cartItems.appendChild(itemDiv);
            });
            document.getElementById('total').textContent = total.toLocaleString();
        }

        // Fungsi hapus item dari keranjang
        function removeFromCart(index) {
            cart.splice(index, 1);
            saveCart();
            updateCart();
        }

        // Fungsi kosongkan keranjang
        function clearCart() {
            cart = [];
            saveCart();
            updateCart();
        }

        // Fungsi simpan keranjang ke localStorage
        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Fungsi checkout
        function checkout() {
            if (cart.length === 0) {
                alert('Keranjang kosong!');
            } else {
                alert('Checkout berhasil! Total: Rp ' + document.getElementById('total').textContent);
                clearCart();
            }
        }

        // Fungsi untuk navigasi section
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            if (sectionId !== 'product-detail') {
                document.getElementById('nav-' + sectionId).classList.add('active');
            }
        }

        // Fungsi untuk profil
        function loadProfile() {
            const name = localStorage.getItem('name') || '';
            const email = localStorage.getItem('email') || '';
            const address = localStorage.getItem('address') || '';
            const phone = localStorage.getItem('phone') || '';
            document.getElementById('profile-name').value = name;
            document.getElementById('profile-email').value = email;
            document.getElementById('profile-address').value = address;
            document.getElementById('profile-phone').value = phone;
        }

        document.getElementById('profile-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('profile-name').value;
            const email = document.getElementById('profile-email').value;
            const address = document.getElementById('profile-address').value;
            const phone = document.getElementById('profile-phone').value;
            localStorage.setItem('name', name);
            localStorage.setItem('email', email);
            localStorage.setItem('address', address);
            localStorage.setItem('phone', phone);
            alert('Profil disimpan!');
        });

        // Fungsi untuk login
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;

            // Simpan data login ke localStorage
            localStorage.setItem('username', username);
            localStorage.setItem('password', password); // Catatan: Jangan simpan password nyata di localStorage!
            localStorage.setItem('name', name);
            localStorage.setItem('phone', phone);

            // Sembunyikan login, tampilkan website utama
            document.getElementById('login').style.display = 'none';
            document.querySelector('header').style.display = 'block';
            document.querySelector('.container').style.display = 'block';
            document.querySelector('footer').style.display = 'block';

            // Load data
            displayProducts();
            updateCart();
            loadProfile();
        });

        // Jalankan saat halaman load - cek apakah sudah login
        window.onload = function() {
            const isLoggedIn = localStorage.getItem('username');
            if (isLoggedIn) {
                // Jika sudah login sebelumnya, langsung tampilkan website
                document.getElementById('login').style.display = 'none';
                document.querySelector('header').style.display = 'block';
                document.querySelector('.container').style.display = 'block';
                document.querySelector('footer').style.display = 'block';
                displayProducts();
                updateCart();
                loadProfile();
            }
        };
    </script>
</body>
</html>
